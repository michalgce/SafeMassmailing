<ui:composition template="index.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
        >
    <ui:define name="content">
        <p:messages id="msgs" showDetail="true" />

        <p:tabView id="tabView">
            <p:tab title="1. Create new configuration">
                <h:form>

                    <h:panelGrid columns="2" cellpadding="5" title="Enter new configuration data.">
                        <p:outputLabel value="Configuration name" for="inputName" />
                        <p:inputText id="inputName" value="#{smtpConfigurationService.name}" required="true" requiredMessage="Enter configuration name" />

                        <p:outputLabel value="SMTP Address (IP or HOST)" for="inputAddress" />
                        <p:inputText id="inputAddress" value="#{smtpConfigurationService.address}" required="true" requiredMessage="Enter SMTP address" />

                        <p:outputLabel value="SMTP PORT" for="inputPort" />
                        <p:inputMask mask="99?999" id="inputPort" value="#{smtpConfigurationService.port}" required="true" requiredMessage="Enter SMTP port" />

                        <p:outputLabel value="SMTP Username" for="inputUserName" />
                        <p:inputText id="inputUserName" value="#{smtpConfigurationService.userName}" />

                        <p:outputLabel value="SMTP Password" for="inputPassword" />
                        <p:password id="inputPassword" value="#{smtpConfigurationService.password}" />

                        <br />

                        <p:commandButton value="Create new SMTP configuration" actionListener="#{smtpConfigurationService.create}"
                                         update="msgs tabView:form:smtpConfDataTable" />
                    </h:panelGrid>
                </h:form>
            </p:tab>
            <p:tab title="2. Edit/Delete configuration">
                <h:form id="form">
                <p:dataTable id="smtpConfDataTable" var="configuration" widgetVar="configurationTable" value="#{smtpConfigurationService.configurations}">
                    <p:column headerText="Status" style="text-align: center; width: 10%">
                        <p:inputSwitch value="#{configuration.active}" disabled="true" />
                    </p:column>
                    <p:column headerText="Configuration name">
                        <h:outputText value="#{configuration.name}" />
                    </p:column>
                    <p:column headerText="SMTP Address">
                        <h:outputText value="#{configuration.address}" />
                    </p:column>
                    <p:column headerText="SMTP Port" style="width: 15%">
                        <h:outputText value="#{configuration.port}" />
                    </p:column>
                    <p:column headerText="SMTP Username">
                        <h:outputText value="#{configuration.userName}" />
                    </p:column>
                    <p:column style="width:10%;text-align: center">
                        <p:commandButton update="tabView:form:configurationDetail" oncomplete="PF('configurationDialog').show()" icon="ui-icon-search" title="View">
                            <f:setPropertyActionListener value="#{configuration}" target="#{smtpConfigurationService.selectedSmtpConfiguration}" />
                        </p:commandButton>
                    </p:column>
                </p:dataTable>

                <p:dialog header="Configuration Info" widgetVar="configurationDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                    <p:outputPanel id="configurationDetail" style="text-align:center;">
                        <p:panelGrid  columns="2" rendered="#{not empty smtpConfigurationService.selectedSmtpConfiguration}">

                            <h:outputText value="Configuration name" />
                            <h:inputText value="#{smtpConfigurationService.selectedSmtpConfiguration.name}" />

                            <h:outputText value="SMTP Host:" />
                            <h:inputText value="#{smtpConfigurationService.selectedSmtpConfiguration.address}" />

                            <h:outputText value="SMTP Port:" />
                            <p:inputMask mask="99?99" value="#{smtpConfigurationService.selectedSmtpConfiguration.port}" />

                            <h:outputText value="SMTP New Password" />
                            <h:inputSecret value="#{smtpConfigurationService.selectedSmtpConfiguration.password}" />

                            <h:outputText value="Is active :" />
                            <p:inputSwitch value="#{smtpConfigurationService.selectedSmtpConfiguration.active}">
                                <p:ajax listener="#{smtpConfigurationService.setAsActive}" />
                            </p:inputSwitch>
                        </p:panelGrid>
                        <hr />
                        <p:commandButton type="reset" value="Reset" />
                        <p:commandButton id="updateButton" value="Update" actionListener="#{smtpConfigurationService.update}" oncomplete="PF('configurationDialog').hide();" update="tabView:form:smtpConfDataTable" />
                    </p:outputPanel>
                </p:dialog>
                </h:form>
            </p:tab>
        </p:tabView>
    </ui:define>
</ui:composition>
